function ExampleGMselection

output=2;    %=1  hazard curve
             %=2  gcim distributions
             
if output==1
    [DSI,Prob]=hazardcurve;
    
    fig1=figure(1);
    axes1=axes('Parent',fig1,'FontSize',16);
    loglog(DSI,Prob,'LineWidth',3,'Color',[1 0 0]);
    xlabel('Displacement spectrum intensity, DSI (cm.s)');
    ylabel('Exceedance probability in 50 years');
    ylim([1e-4 1]); xlim([10 400]);
    grid on;
    text(15,3e-4,{'Lat: 34.053, Long: -118.243';;'V_{s,30}=760m/s'},'FontSize',14,'BackgroundColor',[1 1 1]);
    
elseif output==2
    [PGA,PGV,ASI,SI,CAV,Ds575,Ds595,T,SA]=gcimdistribution;
    %get median, 16th and 84th percentiles of SA
    for i=1:length(T)
        col1=(i-1)*2+1;
        SAmedian(i)=interp1(SA(:,col1+1),SA(:,col1),0.5);
        SAprctiles(i,1:2)=interp1(SA(:,col1+1),SA(:,col1),[0.16 0.84]);
    end
    
    fig1=figure(1);
    axes1=axes('Parent',fig1,'FontSize',16);
    subplot(221);
    set(gca,'FontSize',14);
    plot(PGA(:,1),PGA(:,2),'LineWidth',3,'Color',[1 0 0]);
    xlabel('Peak ground acceleration, PGA (g)');
    ylabel('Cumulative probability');
    grid on;
    xlim([0 0.8]);
    
    subplot(222); set(gca,'FontSize',14);
    plot(PGV(:,1),PGV(:,2),'LineWidth',3,'Color',[1 0 0]);
    xlabel('Peak ground velocity, PGV (cm/s)');
    ylabel('Cumulative probability');
    grid on;
    xlim([0 80]);
    
    subplot(223); set(gca,'FontSize',14);
    plot(SI(:,1),SI(:,2),'LineWidth',3,'Color',[1 0 0]);
    xlabel('Spectrum intensity, SI (cm.s/s)');
    ylabel('Cumulative probability');
    grid on;
    xlim([0 300]);
    
    subplot(224); set(gca,'FontSize',14);
    loglog(T',SAmedian,'LineWidth',3,'Color',[1 0 0]); hold on;
    loglog(T',SAprctiles,'LineWidth',3,'Color',[1 0 0],'LineStyle','--');
    legend('Median','16^{th}, 84^{th} percentiles','Location','SouthWest');
    xlabel('Period, T (s)');
    ylabel('Spectral acceleration, SA (g)');
    grid on;
    set(gcf,'units','normalized'); set(gcf,'Position',[0.1 0.1 0.7 0.7]);
    xlim([0.1 10]); ylim([0.01 1]);
end

%end of function ExampleGMselection
end
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
function [DSI,Prob]=hazardcurve;

hazardcurvedata=[0.05	0.9997861
0.06095	0.9997861
0.0743	0.9997861
0.09058	0.9997861
0.11042	0.9997861
0.13461	0.9997861
0.16409	0.9997861
0.20004	0.9997861
0.24386	0.9997861
0.29727	0.999786
0.36239	0.9997859
0.44177	0.99978554
0.53854	0.9997847
0.6565	0.999783
0.80031	0.99977934
0.97562	0.99977225
1.18932	0.9997591
1.44984	0.99973524
1.76742	0.9996927
2.15457	0.99961627
2.62653	0.9994754
3.20186	0.9992046
3.90322	0.99865603
4.75821	0.9974881
5.80049	0.99491274
7.07107	0.9891914
8.61997	0.9768375
10.50815	0.9518827
12.80993	0.90628856
15.61591	0.8327344
19.03654	0.7292471
23.20644	0.6024663
28.28976	0.46639845
34.48655	0.3371688
42.04074	0.22735628
51.24966	0.14302194
62.47577	0.083989725
76.16092	0.046075113
92.84378	2.36E-02
113.18097	1.13E-02
137.97298	5.06E-03
168.19559	2.11E-03
205.0384	8.21E-04
249.95152	2.97E-04
304.70276	1.00E-04
371.4471	3.13E-05
452.81165	9.11E-06
551.9989	2.46E-06
672.91284	6.20E-07
820.3126	1.45E-07
1000	3.18E-08
];

DSI=hazardcurvedata(:,1); Prob=hazardcurvedata(:,2);
end
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
function [PGA,PGV,ASI,SI,CAV,Ds575,Ds595,T,SA]=gcimdistribution;

PGA=[0.022135737	0.00178844
0.025394091	0.003057393
0.029132071	0.005135514
0.033420277	0.008472925
0.038339702	0.013720877
0.043983261	0.021777838
0.050457544	0.033810281
0.057884835	0.051221869
0.066405414	0.075547044
0.076180211	0.108260152
0.087393848	0.150518076
0.100258118	0.202883797
0.115015994	0.265097908
0.131946211	0.335962519
0.151368536	0.413375006
0.173649805	0.494514327
0.199210849	0.576140706
0.228534449	0.654957021
0.262174448	0.72797026
0.300766214	0.79280255
0.345038643	0.847909449
0.395827921	0.892673232
0.45409332	0.927360056
0.520935316	0.952952607
0.597616374	0.970900119
0.685584793	0.982843664
0.786502058	0.99037508
0.902274225	0.994869673
1.035087917	0.997405393
1.187451626	0.998756517
1.362243091	0.999435886
];

PGV=[5.609262763	5.64E-04
6.138440828	0.001155575
6.717541572	0.002293856
7.351274703	0.004386226
8.044794242	0.008061944
8.803740441	0.014236149
9.634285653	0.024154561
10.54318453	0.039390361
11.53782897	0.061759725
12.6263082	0.093129107
13.8174746	0.135111255
15.12101569	0.188686998
16.54753289	0.253834165
18.10862778	0.329274272
19.81699642	0.412439101
21.68653263	0.499707669
23.73244095	0.586886404
25.97136035	0.669819816
28.42149949	0.744984504
31.10278484	0.809923068
34.03702276	0.863434886
37.2480768	0.90551737
40.76206181	0.937115925
44.60755629	0.959777523
48.81583487	0.975302192
53.42112261	0.985459916
58.46087338	0.991804531
63.97607443	0.99558451
70.01157975	0.997730074
76.61647489	0.998888651
83.84447608	0.999482814
];

SI=[18.73455048	9.08E-04
20.45217275	0.001871211
22.32727018	0.003675383
24.37428042	0.006885743
26.60896477	0.012313141
29.04852961	0.021034751
31.71175878	0.034365272
34.61915831	0.053760931
37.79311423	0.080652904
41.25806498	0.116228473
45.04068957	0.161199754
49.17011299	0.215611452
53.67813048	0.278734263
58.59945233	0.349071287
63.97197112	0.424476275
69.83705352	0.502356194
76.23985879	0.579923345
83.22968647	0.654456607
90.86035599	0.723544234
99.19062104	0.785284472
108.284622	0.838424259
118.2123797	0.882419097
129.0503348	0.917405932
140.881936	0.944093705
153.7982828	0.963593881
167.8988269	0.977225582
183.292138	0.986332491
200.0967397	0.992141185
218.442022	0.995675401
238.4692377	0.997724991
260.3325898	0.998857062
];

ASI=[0.015216365	9.38E-04
0.017517006	0.001843544
0.020165494	0.00351153
0.02321442	0.006480378
0.026724329	0.011565131
0.03076492	0.019909184
0.035416429	0.032973489
0.040771224	0.052421052
0.046935638	0.079877573
0.054032082	0.116599672
0.062201474	0.163141334
0.07160604	0.219140158
0.082432531	0.283316691
0.094895936	0.353693548
0.109243747	0.427941426
0.12576088	0.503701577
0.144775323	0.578773658
0.16666466	0.651150728
0.19186356	0.718984537
0.220872413	0.780592039
0.254267266	0.834564063
0.292711261	0.879948581
0.336967804	0.916415862
0.387915725	0.944314598
0.446566728	0.964581116
0.514085483	0.978533734
0.59181275	0.987624945
0.681292009	0.993225293
0.784300103	0.996483767
0.902882529	0.998272632
1.039394051	0.999198199
];

CAV=[0.147142947	0.001030289
0.161215679	0.002005801
0.176634325	0.003750849
0.193527608	0.006727941
0.212036562	0.011583492
0.232315711	0.019173632
0.254534354	0.030573609
0.278877986	0.047061166
0.305549839	0.070061569
0.334772585	0.101039857
0.366790191	0.141327902
0.401869955	0.191884759
0.440304744	0.253013315
0.482415431	0.324088719
0.528553579	0.403380877
0.579104372	0.488057347
0.634489837	0.574421406
0.69517236	0.658373172
0.761658552	0.73600229
0.834503474	0.804170142
0.914315275	0.860928407
1.001760266	0.905676023
1.097568484	0.939037865
1.202539787	0.962531704
1.317550532	0.978141505
1.443560889	0.987916684
1.581622859	0.993680482
1.732889058	0.99687753
1.898622336	0.998544288
2.080206323	0.999360373
2.279156977	0.99973537
];

Ds575=[1.006157231	0.001160132
1.156772739	0.00232816
1.329934456	0.004448953
1.52901741	0.008085229
1.75790185	0.01398669
2.021048873	0.023078154
2.323587376	0.036416736
2.67141402	0.055123354
3.071308159	0.080300494
3.531063975	0.112947471
4.059642389	0.153875232
4.66734572	0.203609743
5.366018477	0.262268001
6.169278219	0.329401625
7.092780972	0.40383306
8.154526369	0.48354481
9.375208478	0.565702549
10.77861914	0.646873442
12.39211169	0.723442793
14.24713409	0.792151816
16.37984185	0.850610943
18.83180276	0.897638073
21.65080704	0.933321981
24.8917988	0.958811813
28.61794697	0.975924957
32.90187644	0.986709226
37.82708364	0.993081398
43.48956385	0.996608699
49.9996823	0.998436564
57.48432517	0.999322774
66.08937274	0.999724579
];

Ds595=[2.714655556	9.75E-04
3.053781499	0.001969349
3.43527245	0.003799152
3.864420821	0.006987424
4.347180173	0.012256328
4.890247809	0.020534587
5.501157689	0.032933806
6.188384945	0.050691237
6.961463459	0.075082555
7.831118121	0.107310845
8.809413622	0.148375621
9.909921823	0.198920581
11.14791004	0.259060202
12.54055283	0.328197821
14.1071703	0.404875284
15.86949607	0.486718037
17.85197882	0.570545341
20.08212148	0.652679761
22.59086273	0.72942724
25.41300627	0.797625278
28.58770359	0.855110149
32.15899716	0.90097446
36.17643142	0.935548332
40.6957401	0.960136178
45.77961942	0.976612508
51.49859787	0.987005466
57.93201464	0.993171575
65.1691203	0.996610302
73.31031498	0.998411961
82.46854121	0.999298416
92.77085074	0.999707881
];

T=[0.1 0.2 0.3 0.5 1.0 2.0 5.0 10.0];

SA=[0.026604472	0.001949478			0.032815111	0.001040688			0.032861329	8.48E-04			0.03173408	7.73E-04			0.031033755	9.46E-04			0.032856822	0.00122221			0.017553191	0.00146022			0.002196785	0.001377167
0.031038906	0.003355966			0.038353785	0.002006533			0.038214245	0.001732008			0.0364877	0.00162957			0.034862376	0.001927365			0.035657968	0.002365689			0.018554371	0.00273456			0.002433746	0.002645978
0.036212472	0.005656775			0.0448273	0.003759837			0.04443912	0.003401656			0.041953391	0.003276319			0.039163334	0.003747325			0.03869792	0.004398156			0.019612656	0.004936509			0.002696267	0.004871532
0.042248368	0.009340406			0.052393442	0.00683972			0.051677989	0.006418066			0.048237816	0.006280627			0.043994898	0.00696067			0.041997038	0.007858077			0.020731302	0.008594899			0.002987105	0.008605044
0.049290327	0.015102413			0.06123663	0.012054679			0.060096029	0.011615036			0.05546362	0.01147793			0.049422531	0.012361503			0.045577416	0.013500673			0.021913752	0.014440573			0.003309315	0.014601082
0.05750604	0.023883393			0.071572409	0.020528693			0.069885316	0.020134747			0.063771817	0.020000339			0.055519769	0.021006785			0.049463032	0.022319114			0.023163645	0.023425762			0.00366628	0.023828745
0.067091149	0.036875069			0.083652705	0.033687217			0.081269222	0.033400617			0.073324543	0.033246039			0.06236922	0.034194412			0.053679908	0.035530253			0.024484829	0.036713043			0.004061751	0.037449196
0.078273904	0.05546889			0.097771964	0.05314458			0.094507498	0.052997199			0.084308224	0.052765079			0.070063686	0.053377926			0.058256287	0.054508872			0.025881369	0.055619452			0.00449988	0.056748028
0.0913206	0.081127458			0.114274332	0.080477026			0.10990221	0.080450058			0.096937209	0.080057708			0.078707415	0.080011164			0.063222816	0.080661122			0.027357563	0.081505875			0.004985268	0.083017601
0.106541921	0.115178343			0.133562039	0.116911985			0.127804631	0.116939001			0.111457959	0.116313694			0.088417517	0.115335222			0.068612757	0.115240762			0.028917955	0.115611695			0.005523014	0.117395252
0.124300332	0.158558746			0.156105208	0.1630166			0.14862325	0.163018387			0.128153851	0.162152203			0.09932555	0.160141267			0.074462207	0.159128825			0.030567347	0.158849063			0.006118764	0.160676206
0.145018715	0.211567021			0.182453309	0.218494736			0.172833099	0.218434544			0.147350711	0.217434306			0.111579303	0.214557915			0.080810341	0.212613764			0.032310815	0.211587053			0.006778777	0.213130894
0.169190439	0.273689313			0.213248554	0.282175288			0.20098659	0.282104573			0.169423173	0.281203747			0.125344796	0.277913997			0.087699673	0.275219313			0.034153725	0.273468573			0.007509983	0.274361564
0.197391106	0.343555117			0.249241552	0.352198566			0.233726118	0.352260794			0.194801988	0.35177071			0.140808533	0.348714894			0.095176342	0.345626152			0.036101749	0.343307262			0.008320062	0.34323078
0.230292262	0.419038817			0.291309601	0.42632042			0.271798721	0.426698616			0.223982434	0.426905198			0.158180025	0.424746603			0.10329042	0.4217203			0.038160883	0.419101878			0.009217522	0.417884205
0.268677383	0.497483469			0.340478074	0.50220411			0.316073127	0.503031589			0.257533977	0.504077262			0.177694631	0.503288888			0.112096249	0.500772915			0.040337463	0.49818548			0.010211788	0.495874309
0.313460538	0.575988012			0.397945411	0.577603774			0.367559571	0.578882319			0.296111387	0.580688259			0.199616746	0.581403052			0.121652802	0.579728401			0.042638189	0.577495829			0.011313303	0.574374721
0.36570815	0.651702339			0.46511233	0.650421928			0.427432853	0.651992859			0.340467516	0.65426249			0.224243383	0.656241034			0.13202408	0.655551368			0.045070141	0.653924317			0.012533635	0.650459099
0.426664396	0.722084916			0.543615967	0.718710611			0.497059139	0.720296891			0.391467991	0.722603449			0.251908199	0.725328596			0.143279542	0.72556725			0.047640804	0.724677336			0.0138856	0.721405497
0.497780831	0.785105391			0.635369781	0.7807088			0.578027136	0.782008987			0.450108103	0.783929803			0.282986012	0.786783337			0.155494567	0.787735596			0.05035809	0.787582014			0.015383397	0.784979816
0.580750955	0.839385105			0.742610194	0.83496516			0.67218434	0.835754694			0.517532236	0.836994716			0.317897882	0.839440861			0.168750961	0.840811095			0.053230362	0.841279687			0.017042758	0.839652788
0.677550542	0.884268966			0.8679511	0.880518452			0.781679197	0.880713402			0.595056194	0.881171107			0.357116815	0.882880927			0.183137503	0.884374633			0.056266459	0.885279674			0.018881108	0.884710095
0.790484688	0.919818717			1.014447578	0.917051108			0.909010119	0.91671394			0.684192887	0.916473988			0.401174172	0.917359664			0.198750543	0.91874528			0.059475726	0.919879032			0.020917756	0.920240796
0.9222427	0.946722534			1.185670354	0.944934123			1.057082496	0.944229128			0.786681848	0.943499155			0.450666868	0.943668696			0.215694643	0.944806835			0.06286804	0.945982722			0.023174091	0.947010065
1.075962142	0.966130362			1.385792837	0.965129148			1.229274988	0.96425558			0.904523186	0.963282606			0.506265458	0.96295276			0.23408328	0.963793939			0.066453841	0.964874009			0.02567381	0.966251633
1.255303545	0.9794458			1.619692845	0.978979442			1.42951662	0.978111933			1.040016617	0.977111876			0.568723223	0.976519788			0.254039605	0.97708165			0.070244166	0.977985785			0.028443166	0.979429343
1.46453758	0.988117021			1.893071491	0.987959685			1.66237643	0.9872141			1.195806343	0.986332847			0.638886377	0.985674249			0.275697269	0.986011711			0.074250678	0.986711938			0.031511244	0.988017823
1.708646749	0.993467469			2.212592146	0.993457601			1.933167726	0.992885083			1.374932656	0.992192123			0.717705531	0.991594438			0.299201315	0.991773365			0.07848571	0.992279583			0.034910267	0.993339037
1.993444042	0.996590856			2.586042857	0.99663264			2.248069325	0.996233402			1.580891271	0.995737525			0.806248573	0.995261428			0.324709155	0.995341172			0.082962296	0.995684744			0.038675931	0.996470311
2.325711357	0.998313577			3.022526166	0.998360637			2.614266534	0.998105427			1.817701543	0.997778919			0.905715134	0.9974356			0.352391617	0.99746095			0.087694212	0.997680721			0.042847787	0.998218936
2.713360999	0.999210302			3.532680985	0.999246136			3.040115104	0.999095725			2.089984909	0.998896575			1.017452844	0.99866883			0.382434094	0.998669015			0.092696022	0.998801874			0.047469648	0.999144989
];
end